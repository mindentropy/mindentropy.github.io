---
layout: post
title: BeagleBone Black Linux setup for development
date: '2017-12-08T00:23:00.000+05:30'
author: Gautam Bhat
tags: 
modified_time: '2018-01-19T12:54:37.232+05:30'
blogger_id: tag:blogger.com,1999:blog-2655423030126048565.post-6109340027760650870
blogger_orig_url: https://thesoulofamachine.blogspot.com/2017/12/beaglebone-black-linux-setup-for.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">After my wandboard starting behaving weirdly due to some RAM problems I decided to experiment Android and Linux on my BeagleBone Black.<br /><br />BeagleBone Black is a really nice and capable SBC. I will document my Linux experiments similar to Wandboard here. We will first start with the Linux setup and installation.<br /><br />I am going to the use Robert C Nelson (hereafter RCN) trees for building my kernel.<br /><br />We have the BB Kernel tree here: https://github.com/RobertCNelson/bb-kernel.git<br /><br />We do a git clone and git checkout 4.14-rc8-bone3. We can just call the build_kernel.sh which will build the kernel automatically. We can reuse the .config for our customization.<br /><br />We can also use the bleeding edge tree: https://github.com/beagleboard/linux.git<br /><br />In the above tree we can build the image manually. The baremetal toolchains arm-none-eabi- from the Ubuntu repository and the arm-eabi- from the ARM/Linaro toolchain will cause errors in the build. After observing the BB Kernel tree build messages I see that the toolchain used is arm-linux-gnueabihf-. So we do the build as follows:<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2</pre></td><td><pre style="line-height: 125%; margin: 0;">ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make bb.org_defconfig<br />LOADADDR=0x80008000 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make -j10 uImage zImage dtbs modules<br /></pre></td></tr></tbody></table></div><br /><br />This will create the uImage, zImage and dtbs files.<br />We use the debian rootfs: debian-9.2-minimal-armhf-2017-10-10.tar.xz<br />I create two SD card partitions. I do the following after the extraction of the above rootfs assuming the /dev/&lt;partno&gt; is mounted at /mnt/devmnt<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2<br />3</pre></td><td><pre style="line-height: 125%; margin: 0;">sudo tar xfvp rootfs.tar -C /mnt/devmnt<br />sudo chown root:root /mnt/devmnt<br />sudo chown 755 /mnt/devmnt<br /></pre></td></tr></tbody></table></div><br />To load the file we do:<br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2</pre></td><td><pre style="line-height: 125%; margin: 0;">fatload mmc 0:1 0x80008000 uImage<br />fatload mmc 0:1 0x8C008000 am335x-boneblack.dtb<br /></pre></td></tr></tbody></table></div><br />After the above loading we do the following: <!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;">1<br />2</pre></td><td><pre style="line-height: 125%; margin: 0;">setenv bootargs console=ttyO0,115200n8 root=/dev/mmcblk0p2 rw rootfstype=ext4 rootwait<br />bootm 0x80008000 - 0x8C008000<br /></pre></td></tr></tbody></table></div><br />The BeagleBone Black should start booting. Use the username as debian and password as temppwd to login.<br /><br />The above will cause a fault after mounting of the filesystem and running in if you use the Ubuntu tool chain as it. Use the Linaro tool chain which gets downloaded in the dl folder in the tree when build_kernel.sh is called.<br /></div>